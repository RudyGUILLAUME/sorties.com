{% extends 'base.html.twig' %}

{% block title %}Toutes les sorties{% endblock %}

{% block body %}
    <main class="flex-1 container mx-auto px-4 py-8">
        <div class="flex flex-col gap-8">
            <!-- HEADER -->
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <img src="{{ asset('images/logo.png') }}" alt="Sorties" class="rounded-full w-14 h-14 object-cover">
                    <div>
                        <h1 class="text-3xl md:text-4xl font-black leading-tight tracking-[-0.033em] text-text-light dark:text-text-dark">
                            Toutes les sorties
                        </h1>
                        <p class="text-subtle-light dark:text-subtle-dark text-sm">Découvrez toutes les sorties disponibles</p>
                    </div>
                </div>
            </div>

            <!-- FORMULAIRE DE RECHERCHE -->
            <div class="p-6 rounded-xl bg-white dark:bg-[#192633] border border-border-light dark:border-border-dark shadow-sm">
                <h2 class="text-lg font-bold text-text-light dark:text-text-dark mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">filter_alt</span>
                    Filtrer les sorties
                </h2>

                {{ form_start(searchForm, {attr: {class: 'grid grid-cols-1 md:grid-cols-4 gap-4'}}) }}

                <!-- 🔍 Champ de recherche -->
                <div class="flex flex-col">
                    <label class="text-sm font-medium text-text-light dark:text-text-dark mb-1">{{ form_label(searchForm.q) }}</label>
                    {{ form_widget(searchForm.q, {
                        'attr': {
                            'class': 'w-full h-11 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark px-4 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none transition'
                        }
                    }) }}
                </div>

                <!-- 🏢 Site -->
                <div class="flex flex-col">
                    <label class="text-sm font-medium text-text-light dark:text-text-dark mb-1">{{ form_label(searchForm.site) }}</label>
                    {{ form_widget(searchForm.site, {
                        'attr': {
                            'class': 'w-full h-11 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark px-4 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none transition'
                        }
                    }) }}
                </div>

                <!-- 📅 Dates -->
                <div class="flex flex-col">
                    <label class="text-sm font-medium text-text-light dark:text-text-dark mb-1">{{ form_label(searchForm.dateMin) }}</label>
                    {{ form_widget(searchForm.dateMin, {
                        'attr': {
                            'class': 'w-full h-11 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark px-4 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none transition'
                        }
                    }) }}
                </div>

                <div class="flex flex-col">
                    <label class="text-sm font-medium text-text-light dark:text-text-dark mb-1">{{ form_label(searchForm.dateMax) }}</label>
                    {{ form_widget(searchForm.dateMax, {
                        'attr': {
                            'class': 'w-full h-11 rounded-lg border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark px-4 text-sm focus:ring-2 focus:ring-primary focus:border-primary outline-none transition'
                        }
                    }) }}
                </div>

                <!-- 🧠 Filtres secondaires -->
                <div class="md:col-span-4 flex flex-wrap items-center gap-3 pt-4 border-t border-border-light dark:border-border-dark mt-2">

                    <!-- Cases à cocher -->
                    {% for field in [searchForm.organisateur, searchForm.inscrit, searchForm.nonInscrit, searchForm.passees] %}
                        <label class="flex items-center gap-2 text-sm font-medium text-text-light dark:text-text-dark">
                            {{ form_widget(field, {
                                'attr': {
                                    'class': 'rounded border-gray-300 dark:border-gray-600 text-primary focus:ring-primary'
                                }
                            }) }}
                            {{ form_label(field) }}
                        </label>
                    {% endfor %}

                    <!-- Boutons -->
                    <div class="ms-auto flex gap-2 mt-3 md:mt-0">
                        <button type="submit"
                                class="flex items-center justify-center h-10 px-5 bg-primary text-white rounded-lg text-sm font-semibold hover:bg-primary/90 transition">
                            <span class="material-symbols-outlined text-sm mr-1">search</span>
                            Rechercher
                        </button>

                        <a href="{{ path('app_sortie_index') }}"
                           class="flex items-center justify-center h-10 px-5 text-sm rounded-lg bg-background-light dark:bg-background-dark border border-border-light dark:border-border-dark hover:bg-secondary-light/70 dark:hover:bg-secondary-dark/60 transition">
                            <span class="material-symbols-outlined text-sm mr-1">restart_alt</span>
                            Réinitialiser
                        </a>
                    </div>
                </div>

                {{ form_end(searchForm) }}
            </div>


            <!-- LISTE DES SORTIES -->
            {% include 'sortie/table.html.twig' with { 'sorties': sorties } %}
        </div>
    </main>
{% endblock %}
